1- Banco de dados para auxiliar website de loja online de produtos de segurança. Deve conter informações relevantes para que seja realizada a compra de produtos, 
acompanhamento de pedidos, relação de vendas por funcionário, aplicação de cupons, entre outros. 

cliente (id_cliente, nome, idade, telefone, id_endereco);
pedido (id_pedido, id_cliente, id_cupom, id_funcionario, data);
item (id_item, id_produto, id_Pedido, qnd);
produto (id_produto, nome, preço, qtd_disponivel);
envio (id_envio, id_status_pedido, id_pedido);
status_pedido (id_status_pedido, nome);
endereço (id_endereço, id_cidade, rua, numero);
cidade (id_cidade, nome, id_uf);
uf (id_uf, nome);
cupom (id_cupom, nome, porcentagem, status);
funcionario (id_funcionario, nome);



1. Selecione o nome do produto e o valor total de vendas para aquele produto. Traga apenas os 2 produtos mais vendidos, ex:
	PRODUTO  |  VALOR_TOTAL
	Produto 1     |  500.000,00
	Produto 2     |  250.000,00

SELECT p.nome, COUNT(i.id_produto)*p.preco as Valor_Total FROM produto as p
JOIN item as i on p.id_produto=i.id_produto
GROUP BY p.nome
DESC
LIMIT 2


2. Selecione o nome da cidade e quantidade de produtos vendidos naquela cidade em um determinado ano, ex:
	CIDADE  | PRODUTO  | QUANTIDADE |  ANO
          Palmares   | Produto 1      | 19                       | 2023
          Palmares   | Produto 2      | 196                     | 2022
		…


3. Selecione o nome do cliente, o telefone do cliente, o nome da cidade do cliente, para todos os clientes que possuem pedidos atrasados, ex:
CLIENTE | TELEFONE | CIDADE 
           Fernanda   | 81 98165423 | Palmares
           Maria        | 81 585423 | Ribeirão

SELECT c.nome, c.telefone, ci.nome  FROM cliente as c 
JOIN endereco as e ON e.id_endereco = c.endereco
JOIN cidade as ci ON ci.id_cidade = e.id_cidade
JOIN pedido as pe ON pe.id_cliente = c.id_cliente
JOIN envio as en ON en.id_pedido = pe.id_pedido
WHERE en.id_status_pedido = 3;


4. Selecione o nome do produto mais vendido em cada cidade, ex:
	CIDADE | PRODUTO | QUANTIDADE_ITENS
	Palmares | Produto 1     | 450
	Recife     | Produto  2    | 850
	Olinda    | Produto 2      | 850

SELECT c.nome AS CIDADE, p.nome AS PRODUTO, SUM(i.qtd) AS QUANTIDADE_ITENS
FROM item i
JOIN produto p 
ON i.id_produto = p.id_produto
JOIN pedido pe
ON i.id_pedido = pe.id_pedido
JOIN cliente cl 
ON pe.id_cliente = cl.id_cliente
JOIN endereco e 
ON cl.endereco = e.id_endereco
JOIN cidade c 
ON e.id_cidade = c.id_cidade
GROUP BY c.nome, p.nome;




5. Selecione a lista com os 5 cupons mais utilizados no ano de 2023, ex:
	CUPOM 		| QUANTIDADE
	Cupom Pondé     | 199
	Cupom Karnal     | 200

SELECT cu.nome as cupom, COUNT(cu.nome) as quantidade FROM pedido as p
JOIN cupom as cu
ON p.id_cupom = cu.id_cupom
WHERE YEAR(p.data_pedido) = 2023
GROUP BY cu.nome
LIMIT 5;




6. Selecione os nomes dos produtos que tiveram o total de vendas superior à média de vendas dos outros produtos. ex:
	PRODUTO
	Produto 1


7. Selecione o nome do cliente, o telefone, a cidade, o estado, a data do pedido, o total (preço) do pedido e a quantidade de itens comprados, 
ordenados por data (da mais recente para a mais antiga);

SELECT c.nome AS nome_cliente, c.telefone, cid.nome AS cidade, uf.nome AS estado, pe.data_pedido AS data_pedido, i.qtd as quantidade, SUM(p.preco) AS total_pedido 
FROM cliente c 
JOIN endereco e 
ON c.endereco = e.id_endereco 
JOIN cidade cid 
ON e.id_cidade = cid.id_cidade
JOIN uf 
ON cid.id_uf = uf.id_uf 
JOIN pedido pe 
ON c.id_cliente = pe.id_cliente 
JOIN item i
ON pe.id_pedido = i.id_pedido 
JOIN produto p 
ON i.id_produto = p.id_produto 
GROUP BY pe.data_pedido DESC;



8. Selecione o percentual de pedidos atrasados, considerando todos os pedidos pendentes, ex:
	PERCENTUAL_ATRASOS
	65%
SELECT (COUNT(CASE WHEN sp.id_status_pedido = 3 THEN 1 END) / COUNT(CASE WHEN sp.id_status_pedido = 2 OR sp.id_status_pedido = 3 THEN 1 END)) * 100 AS percentual_atrasado 
FROM pedido p JOIN envio e ON p.id_pedido = e.id_pedido JOIN status_pedido sp ON e.id_status_pedido = sp.id_status_pedido 
WHERE sp.id_status_pedido IN (2, 3);
9. Selecione a média de idade dos clientes que compram cada produto, ex:
	PRODUTO | MEDIA_IDADE
	Produto 1    |  25
	Produto 2    |  45

SELECT p.nome, AVG(c.idade) FROM 
produto as p 
JOIN item as i ON i.id_produto = p.id_produto
JOIN pedido as pe ON pe.id_pedido = i.id_pedido
JOIN cliente as c ON c.id_cliente = pe.id_cliente
GROUP BY p.id_produto


10. Selecione o relatório de uso de todos os cupons. Ordene os resultados pela data, da mais antiga para a mais nova. Além disso, 
traga apenas os resultados de 2023 e não considere os cupons de 100% de desconto ex:
DATA_PEDIDO | NOME_CUPOM | PERCENTAGEM | NOME_CLIENTE | NOME_FUNCIONARIO | TOTAL_COMPRA

SELECT p.data_pedido as DATA_PEDIDO, cu.nome as NOME_CUPOM, cu.porcentagem as PERCENTAGEM, c.nome as CLIENTE, f.nome as NOME_FUNCIONARIO, SUM(i.qtd * pr.preco) as TOTAL_COMPRA
FROM pedido as p
JOIN cliente as c ON c.id_cliente = p.id_cliente
JOIN cupom as cu ON cu.id_cupom = p.id_cupom
JOIN funcionario as f ON f.id_func = p.id_funcionario
JOIN item as i ON i.id_pedido = p.id_pedido
JOIN produto as pr ON pr.id_produto = i.id_produto
WHERE YEAR(p.data_pedido) = 2023 AND cu.porcentagem != '100%'
GROUP BY p.id_pedido
ORDER BY p.data_pedido ASC;


