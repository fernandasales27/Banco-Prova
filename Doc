1- Banco de dados para auxiliar website de loja online de produtos de segurança. Deve conter informações relevantes para que seja realizada a compra de produtos, 
acompanhamento de pedidos, relação de vendas por funcionário, aplicação de cupons, entre outros. 

cliente (id_cliente, nome, idade, telefone, id_endereco);
pedido (id_pedido, id_cliente, id_cupom, id_funcionario, data);
item (id_item, id_produto, id_Pedido, qnt);
produto (id_produto, nome, preço, qtd_disponivel);
envio (id_envio, id_status_pedido, id_pedido);
status_pedido (id_status_pedido, nome);
endereço (id_endereço, id_cidade, rua, numero);
cidade (id_cidade, nome, id_uf);
uf (id_uf, nome);
cupom (id_cupom, nome, porcentagem, status);
funcionario (id_funcionario, nome);



1. Selecione o nome do produto e o valor total de vendas para aquele produto. Traga apenas os 2 produtos mais vendidos, ex:
	PRODUTO  |  VALOR_TOTAL
	Produto 1     |  500.000,00
	Produto 2     |  250.000,00

SELECT p.nome, COUNT(i.id_produto)*p.preco as Valor_Total FROM produto as p
JOIN item as i on p.id_produto=i.id_produto
GROUP BY p.nome
DESC
LIMIT 2


2. Selecione o nome da cidade e quantidade de produtos vendidos naquela cidade em um determinado ano, ex:
	CIDADE  | PRODUTO  | QUANTIDADE |  ANO
          Palmares   | Produto 1      | 19                       | 2023
          Palmares   | Produto 2      | 196                     | 2022
		…

3. Selecione o nome do cliente, o telefone do cliente, o nome da cidade do cliente, para todos os clientes que possuem pedidos atrasados, ex:
CLIENTE | TELEFONE | CIDADE 
           Fernanda   | 81 98165423 | Palmares
           Maria        | 81 585423 | Ribeirão

SELECT c.nome, c.telefone, ci.nome  FROM cliente as c 
JOIN endereco as e ON e.id_endereco = c.endereco
JOIN cidade as ci ON ci.id_cidade = e.id_cidade
JOIN pedido as pe ON pe.id_cliente = c.id_cliente
JOIN envio as en ON en.id_pedido = pe.id_pedido
WHERE en.id_status_pedido = 3;


4. Selecione o nome do produto mais vendido em cada cidade, ex:
	CIDADE | PRODUTO | QUANTIDADE_ITENS
	Palmares | Produto 1     | 450
	Recife     | Produto  2    | 850
	Olinda    | Produto 2      | 850

ERRADO
SELECT ci.nome, resultado.p, resultado.qtd FROM (SELECT COUNT(i.id_pedido) as qtd, 				  i.id_produto as p FROM item as i
      GROUP BY i.id_produto) as resultado
JOIN cliente as c
JOIN endereco as e ON e.id_endereco = c.endereco
JOIN cidade as ci ON ci.id_cidade = e.id_cidade
JOIN pedido as pe ON pe.id_cliente = c.id_cliente




5. Selecione a lista com os 5 cupons mais utilizados no ano de 2023, ex:
	CUPOM 		| QUANTIDADE
	Cupom Pondé     | 199
	Cupom Karnal     | 200

6. Selecione os nomes dos produtos que tiveram o total de vendas superior à média de vendas dos outros produtos. ex:
	PRODUTO
	Produto 1

7. Selecione o nome do cliente, o telefone, a cidade, o estado, a data do pedido, o total (preço) do pedido e a quantidade de itens comprados, 
ordenados por data (da mais recente para a mais antiga);

8. Selecione o percentual de pedidos atrasados, considerando todos os pedidos pendentes, ex:
	PERCENTUAL_ATRASOS
	65%

9. Selecione a média de idade dos clientes que compram cada produto, ex:
	PRODUTO | MEDIA_IDADE
	Produto 1    |  25
	Produto 2    |  45

10. Selecione o relatório de uso de todos os cupons. Ordene os resultados pela data, da mais antiga para a mais nova. Além disso, 
traga apenas os resultados de 2023 e não considere os cupons de 100% de desconto ex:
DATA_PEDIDO | NOME_CUPOM | PERCENTAGEM | NOME_CLIENTE | NOME_FUNCIONARIO | TOTAL_COMPRA
